<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .chat-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 350px;
            height: 500px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            z-index: 1000;
        }
        .chat-header {
            background: linear-gradient(to right, #007bff, #0056b3);
            color: white;
            padding: 15px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .chat-body {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }
        .chat-footer {
            padding: 15px;
            border-top: 1px solid #ddd;
            display: flex;
            gap: 10px;
        }
        .chat-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            outline: none;
        }
        .chat-send {
            padding: 10px 15px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        .floating-button {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 60px;
            height: 60px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 999;
        }
        .status {
            background: #e9ecef;
            padding: 15px;
            margin: 20px;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
        .button-test {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            cursor: pointer;
        }
        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Chat Debug Test</h1>
    
    <div class="status">
        <h3>Estado do Chat</h3>
        <p>Chat Aberto: <span id="chatStatus">false</span></p>
        <p>Propriedade: <span id="propertyStatus">Nenhuma</span></p>
        <p>Modo: <span id="modeStatus">details</span></p>
    </div>
    
    <div class="status">
        <h3>Testes de Bot√£o</h3>
        <button class="button-test" onclick="testViewDetails()">üîµ Test View Details</button>
        <button class="button-test" onclick="testScheduleVisit()">üìÖ Test Schedule Visit</button>
        <button class="button-test" onclick="openChatTest()">üí¨ Open Chat</button>
        <button class="button-test" onclick="closeChatTest()">‚ùå Close Chat</button>
    </div>
    
    <!-- Floating Chat Button -->
    <button id="floatingButton" class="floating-button" onclick="openChatTest()">
        üí¨
    </button>
    
    <!-- Chat Container -->
    <div id="chatContainer" class="chat-container hidden">
        <div class="chat-header">
            <div>
                <h4>Real Estate Assistant</h4>
                <small>üß™ Demo Mode ‚Ä¢ Active</small>
            </div>
            <button onclick="closeChatTest()" style="background:none;border:none;color:white;font-size:18px;cursor:pointer;">‚úï</button>
        </div>
        
        <div class="chat-body">
            <div id="messages">
                <p><strong>Emma - Property Expert:</strong></p>
                <p>üëã Hello! Welcome to Real Estate Assistant</p>
                <p>I'm here to help you with property information and scheduling.</p>
                <p>üí¨ How can I assist you today?</p>
            </div>
        </div>
        
        <div class="chat-footer">
            <input 
                type="text" 
                class="chat-input" 
                placeholder="Ask about property details..."
                id="messageInput"
                onkeypress="handleKeyPress(event)"
            >
            <button class="chat-send" onclick="sendMessage()">Send</button>
        </div>
    </div>

    <script>
        let chatOpen = false;
        let currentProperty = null;
        let currentMode = 'details';
        
        function updateStatus() {
            document.getElementById('chatStatus').textContent = chatOpen;
            document.getElementById('propertyStatus').textContent = currentProperty || 'Nenhuma';
            document.getElementById('modeStatus').textContent = currentMode;
        }
        
        function testViewDetails() {
            console.log('üîµ View Details button clicked!');
            currentProperty = '3590 Coral Way, Apt 502, Miami, FL 33145';
            currentMode = 'details';
            openChatTest();
            updateStatus();
        }
        
        function testScheduleVisit() {
            console.log('üìÖ Schedule Visit button clicked!');
            currentProperty = '3590 Coral Way, Apt 502, Miami, FL 33145';
            currentMode = 'schedule';
            openChatTest();
            updateStatus();
        }
        
        function openChatTest() {
            console.log('üî• Opening chat');
            chatOpen = true;
            document.getElementById('chatContainer').classList.remove('hidden');
            document.getElementById('floatingButton').classList.add('hidden');
            updateStatus();
        }
        
        function closeChatTest() {
            console.log('‚ùå Closing chat');
            chatOpen = false;
            document.getElementById('chatContainer').classList.add('hidden');
            document.getElementById('floatingButton').classList.remove('hidden');
            updateStatus();
        }
        
        function sendMessage() {
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            if (message) {
                console.log('üí¨ Sending message:', message);
                
                // Add user message
                const messagesDiv = document.getElementById('messages');
                messagesDiv.innerHTML += `<p><strong>User:</strong> ${message}</p>`;
                
                // Simulate agent response
                setTimeout(() => {
                    messagesDiv.innerHTML += `<p><strong>Emma:</strong> I understand you're asking about "${message}". This is a demo response.</p>`;
                    messagesDiv.scrollTop = messagesDiv.scrollHeight;
                }, 1000);
                
                input.value = '';
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }
        }
        
        function handleKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }
        
        // Initialize
        updateStatus();
    </script>
</body>
</html> 